[build]
  command = "npm run build"
  publish = "dist"
  functions = "netlify/functions"

[functions]
  node_bundler = "esbuild"

[functions."proposal_pdf"]
  timeout = 26
  memory = 1536

# API endpoints apuntan a funciones locales
[[redirects]]
  from = "/api/cotizacion_v2"
  to   = "/.netlify/functions/cotizacion_v2"
  status = 200
  force = true

[[redirects]]
  from = "/api/ocr_cfe"
  to   = "/.netlify/functions/ocr_cfe"
  status = 200
  force = true

[[redirects]]
  from = "/api/referral"
  to   = "/.netlify/functions/referral"
  status = 200
  force = true

[[redirects]]
  from = "/api/proposal_pdf"
  to   = "/.netlify/functions/proposal_pdf"
  status = 200
  force = true

# Fallback SPA global (deja esto al final)
[[redirects]]
  from = "/*"
  to   = "/index.html"
  status = 200
